<div class="container">
  <div class="d-flex justify-content-between align-items-center pt-3 pb-2 mb-2 border-bottom">
    <h1 class="fw-bold fs-4">Lista zadań</h1>
  </div>
  <div class="d-flex align-items-center my-3">
    <button class="btn btn-primary d-flex align-items-center me-1 btn-sm">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" style="fill: currentColor;" class="me-2"
        viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
        <path
          d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z" />
      </svg>
      Dodaj zadanie
    </button>
    <button class="btn btn-outline-secondary d-flex align-items-center btn-sm">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" style="fill: currentColor;" class="me-2"
        viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
        <path
          d="M3.9 54.9C10.5 40.9 24.5 32 40 32l432 0c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9 320 448c0 12.1-6.8 23.2-17.7 28.6s-23.8 4.3-33.5-3l-64-48c-8.1-6-12.8-15.5-12.8-25.6l0-79.1L9 97.3C-.7 85.4-2.8 68.8 3.9 54.9z" />
      </svg>
      Filtruj
      </button>
  </div>
  <ul class="list-unstyled">
    @for (task of tasks; track $index) {
      <li class="border border-2 rounded my-2 p-2 transition-hover hover-shadow">
        <div class="d-flex" [ngClass]="{ 'completed': task.status === 'Completed' }" (click)="toggleTaskStatus(task)">
          <div class="flex-shrink-0" [title]="task.status">
            @switch (task.status) {
              @case ('Planned') {
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" style="fill: currentColor;"  class="text-muted"
                  viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
                  <path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z" />
                </svg>
              }
              @case ('Pending') {
              <svg xmlns="http://www.w3.org/2000/svg"  width="20" height="20" style="fill: currentColor;"  class="text-warning"
                viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
                <path
                  d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" />
              </svg>
              }
              @case ('Completed') {
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" style="fill: currentColor;"  class="text-success"
                viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
                <path
                  d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z" />
              </svg>
              }
            }
          </div>
          <div class="flex-grow-1 ms-3">
            <div>
              <b [ngClass]="{ 'text-decoration-line-through text-muted': task.status === 'Completed'}">{{ task.name }}</b>
            </div>
            <div class="d-flex align-items-center">
              <!-- <span class="badge bg-secondary me-2" [ngClass]="{'bg-success': task.status === 'Completed', 'bg-warning': task.status === 'Pending'}">{{ task.status }}</span> -->
              <span class="" [ngClass]="getDeadlineClass(task.date)">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" style="fill: currentColor;" 
                  viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
                  <path
                    d="M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40L64 64C28.7 64 0 92.7 0 128l0 16 0 48L0 448c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-256 0-48 0-16c0-35.3-28.7-64-64-64l-40 0 0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40L152 64l0-40zM48 192l352 0 0 256c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16l0-256z" />
                </svg>
                {{ getDeadlineLabel(task.date) }}
              </span>
              <button class='btn btn-outline-secondary btn-sm ms-auto border-0'
                (click)="toggleDescription(task.id);$event.stopPropagation()">
                @if (descVisible[task.id]) {
                  Ukryj opis
                } 
                @else {
                  Pokaż opis
                }
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" style="fill: currentColor;"  class="text-muted ms-1" [style.transform]="descVisible[task.id] ? 'rotate(180deg)' : 'rotate(0deg)'"
                  viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
                  <path
                    d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z" />
                </svg>
              </button>

            </div>
            @if (descVisible[task.id]) {
              <p class="text-muted mb-0">
                {{ task?.description }}
              </p>
            }
          </div>
        </div>
      </li>
    }
  </ul>
</div>
